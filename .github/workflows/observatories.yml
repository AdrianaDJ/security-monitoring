name: "Check Server Configs"
on:
  # schedule:
  # - cron: "0 0 * * *"
  push:
    

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        domain:
          - app.wire.com
          - wire.com
          - account.wire.com
          - teams.wire.com
          - prod-nginz-https.wire.com
          - prod-nginz-ssl.wire.com
    steps:
      - uses: actions/setup-go@v2
      - name: Setup
        run: go get github.com/mozilla/tls-observatory/tlsobs
      - name: Observatory
        run: |
          npx observatory-cli ${{ matrix.domain }} --format=report --rescan --attempts=20
          npx observatory-cli ${{ matrix.domain }} --format=report --rescan --attempts=20 --min-score=80 --min-grade=B
      - name: TLS Observatory
        run: $(go env GOPATH)/bin/tlsobs --targetLevel=intermediate ${{ matrix.domain }}
